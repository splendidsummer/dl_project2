import tensorflow as tf
import configs

b6_layer_names = ['input_5', 'rescaling_4', 'normalization_2', 'rescaling_5', 'stem_conv_pad', 'stem_conv', 'stem_bn', 'stem_activation',
                  'block1a_dwconv', 'block1a_bn', 'block1a_activation', 'block1a_se_squeeze', 'block1a_se_reshape', 'block1a_se_reduce', 'block1a_se_expand', 'block1a_se_excite', 'block1a_project_conv', 'block1a_project_bn',
                  'block1b_dwconv', 'block1b_bn', 'block1b_activation', 'block1b_se_squeeze', 'block1b_se_reshape', 'block1b_se_reduce', 'block1b_se_expand', 'block1b_se_excite', 'block1b_project_conv', 'block1b_project_bn', 'block1b_drop', 'block1b_add',
                  'block1c_dwconv', 'block1c_bn', 'block1c_activation', 'block1c_se_squeeze', 'block1c_se_reshape', 'block1c_se_reduce', 'block1c_se_expand', 'block1c_se_excite', 'block1c_project_conv', 'block1c_project_bn', 'block1c_drop', 'block1c_add',
                  'block2a_expand_conv', 'block2a_expand_bn', 'block2a_expand_activation', 'block2a_dwconv_pad', 'block2a_dwconv', 'block2a_bn', 'block2a_activation', 'block2a_se_squeeze', 'block2a_se_reshape', 'block2a_se_reduce', 'block2a_se_expand', 'block2a_se_excite', 'block2a_project_conv', 'block2a_project_bn',
                  'block2b_expand_conv', 'block2b_expand_bn', 'block2b_expand_activation', 'block2b_dwconv', 'block2b_bn', 'block2b_activation', 'block2b_se_squeeze', 'block2b_se_reshape', 'block2b_se_reduce', 'block2b_se_expand', 'block2b_se_excite', 'block2b_project_conv', 'block2b_project_bn', 'block2b_drop', 'block2b_add',
                  'block2c_expand_conv', 'block2c_expand_bn', 'block2c_expand_activation', 'block2c_dwconv', 'block2c_bn', 'block2c_activation', 'block2c_se_squeeze', 'block2c_se_reshape', 'block2c_se_reduce', 'block2c_se_expand', 'block2c_se_excite', 'block2c_project_conv', 'block2c_project_bn', 'block2c_drop', 'block2c_add',
                  'block2d_expand_conv', 'block2d_expand_bn', 'block2d_expand_activation', 'block2d_dwconv', 'block2d_bn', 'block2d_activation', 'block2d_se_squeeze', 'block2d_se_reshape', 'block2d_se_reduce', 'block2d_se_expand', 'block2d_se_excite', 'block2d_project_conv', 'block2d_project_bn', 'block2d_drop', 'block2d_add',
                  'block2e_expand_conv', 'block2e_expand_bn', 'block2e_expand_activation', 'block2e_dwconv', 'block2e_bn', 'block2e_activation', 'block2e_se_squeeze', 'block2e_se_reshape', 'block2e_se_reduce', 'block2e_se_expand', 'block2e_se_excite', 'block2e_project_conv', 'block2e_project_bn', 'block2e_drop', 'block2e_add',
                  'block2f_expand_conv', 'block2f_expand_bn', 'block2f_expand_activation', 'block2f_dwconv', 'block2f_bn', 'block2f_activation', 'block2f_se_squeeze', 'block2f_se_reshape', 'block2f_se_reduce', 'block2f_se_expand', 'block2f_se_excite', 'block2f_project_conv', 'block2f_project_bn', 'block2f_drop', 'block2f_add', 'block3a_expand_conv', 'block3a_expand_bn', 'block3a_expand_activation', 'block3a_dwconv_pad', 'block3a_dwconv', 'block3a_bn', 'block3a_activation', 'block3a_se_squeeze', 'block3a_se_reshape', 'block3a_se_reduce', 'block3a_se_expand', 'block3a_se_excite', 'block3a_project_conv', 'block3a_project_bn', 'block3b_expand_conv', 'block3b_expand_bn', 'block3b_expand_activation', 'block3b_dwconv', 'block3b_bn', 'block3b_activation', 'block3b_se_squeeze', 'block3b_se_reshape', 'block3b_se_reduce', 'block3b_se_expand', 'block3b_se_excite', 'block3b_project_conv', 'block3b_project_bn', 'block3b_drop', 'block3b_add', 'block3c_expand_conv', 'block3c_expand_bn', 'block3c_expand_activation', 'block3c_dwconv', 'block3c_bn', 'block3c_activation', 'block3c_se_squeeze', 'block3c_se_reshape', 'block3c_se_reduce', 'block3c_se_expand', 'block3c_se_excite', 'block3c_project_conv', 'block3c_project_bn', 'block3c_drop', 'block3c_add', 'block3d_expand_conv', 'block3d_expand_bn', 'block3d_expand_activation', 'block3d_dwconv', 'block3d_bn', 'block3d_activation', 'block3d_se_squeeze', 'block3d_se_reshape', 'block3d_se_reduce', 'block3d_se_expand', 'block3d_se_excite', 'block3d_project_conv', 'block3d_project_bn', 'block3d_drop', 'block3d_add', 'block3e_expand_conv', 'block3e_expand_bn', 'block3e_expand_activation', 'block3e_dwconv', 'block3e_bn', 'block3e_activation', 'block3e_se_squeeze', 'block3e_se_reshape', 'block3e_se_reduce', 'block3e_se_expand', 'block3e_se_excite', 'block3e_project_conv', 'block3e_project_bn', 'block3e_drop', 'block3e_add', 'block3f_expand_conv', 'block3f_expand_bn', 'block3f_expand_activation', 'block3f_dwconv', 'block3f_bn', 'block3f_activation', 'block3f_se_squeeze', 'block3f_se_reshape', 'block3f_se_reduce', 'block3f_se_expand', 'block3f_se_excite', 'block3f_project_conv', 'block3f_project_bn', 'block3f_drop', 'block3f_add', 'block4a_expand_conv', 'block4a_expand_bn', 'block4a_expand_activation', 'block4a_dwconv_pad', 'block4a_dwconv', 'block4a_bn', 'block4a_activation', 'block4a_se_squeeze', 'block4a_se_reshape', 'block4a_se_reduce', 'block4a_se_expand', 'block4a_se_excite', 'block4a_project_conv', 'block4a_project_bn', 'block4b_expand_conv', 'block4b_expand_bn', 'block4b_expand_activation', 'block4b_dwconv', 'block4b_bn', 'block4b_activation', 'block4b_se_squeeze', 'block4b_se_reshape', 'block4b_se_reduce', 'block4b_se_expand', 'block4b_se_excite', 'block4b_project_conv', 'block4b_project_bn', 'block4b_drop', 'block4b_add', 'block4c_expand_conv', 'block4c_expand_bn', 'block4c_expand_activation', 'block4c_dwconv', 'block4c_bn', 'block4c_activation', 'block4c_se_squeeze', 'block4c_se_reshape', 'block4c_se_reduce', 'block4c_se_expand', 'block4c_se_excite', 'block4c_project_conv', 'block4c_project_bn', 'block4c_drop', 'block4c_add', 'block4d_expand_conv', 'block4d_expand_bn', 'block4d_expand_activation', 'block4d_dwconv', 'block4d_bn', 'block4d_activation', 'block4d_se_squeeze', 'block4d_se_reshape', 'block4d_se_reduce', 'block4d_se_expand', 'block4d_se_excite', 'block4d_project_conv', 'block4d_project_bn', 'block4d_drop', 'block4d_add', 'block4e_expand_conv', 'block4e_expand_bn', 'block4e_expand_activation', 'block4e_dwconv', 'block4e_bn', 'block4e_activation', 'block4e_se_squeeze', 'block4e_se_reshape', 'block4e_se_reduce', 'block4e_se_expand', 'block4e_se_excite', 'block4e_project_conv', 'block4e_project_bn', 'block4e_drop', 'block4e_add', 'block4f_expand_conv', 'block4f_expand_bn', 'block4f_expand_activation', 'block4f_dwconv', 'block4f_bn', 'block4f_activation', 'block4f_se_squeeze', 'block4f_se_reshape', 'block4f_se_reduce', 'block4f_se_expand', 'block4f_se_excite', 'block4f_project_conv', 'block4f_project_bn', 'block4f_drop', 'block4f_add', 'block4g_expand_conv', 'block4g_expand_bn', 'block4g_expand_activation', 'block4g_dwconv', 'block4g_bn', 'block4g_activation', 'block4g_se_squeeze', 'block4g_se_reshape', 'block4g_se_reduce', 'block4g_se_expand', 'block4g_se_excite', 'block4g_project_conv', 'block4g_project_bn', 'block4g_drop', 'block4g_add', 'block4h_expand_conv', 'block4h_expand_bn', 'block4h_expand_activation', 'block4h_dwconv', 'block4h_bn', 'block4h_activation', 'block4h_se_squeeze', 'block4h_se_reshape', 'block4h_se_reduce', 'block4h_se_expand', 'block4h_se_excite', 'block4h_project_conv', 'block4h_project_bn', 'block4h_drop', 'block4h_add', 'block5a_expand_conv', 'block5a_expand_bn', 'block5a_expand_activation', 'block5a_dwconv', 'block5a_bn', 'block5a_activation', 'block5a_se_squeeze', 'block5a_se_reshape', 'block5a_se_reduce', 'block5a_se_expand', 'block5a_se_excite', 'block5a_project_conv', 'block5a_project_bn', 'block5b_expand_conv', 'block5b_expand_bn', 'block5b_expand_activation', 'block5b_dwconv', 'block5b_bn', 'block5b_activation', 'block5b_se_squeeze', 'block5b_se_reshape', 'block5b_se_reduce', 'block5b_se_expand', 'block5b_se_excite', 'block5b_project_conv', 'block5b_project_bn', 'block5b_drop', 'block5b_add', 'block5c_expand_conv', 'block5c_expand_bn', 'block5c_expand_activation', 'block5c_dwconv', 'block5c_bn', 'block5c_activation', 'block5c_se_squeeze', 'block5c_se_reshape', 'block5c_se_reduce', 'block5c_se_expand', 'block5c_se_excite', 'block5c_project_conv', 'block5c_project_bn', 'block5c_drop', 'block5c_add', 'block5d_expand_conv', 'block5d_expand_bn', 'block5d_expand_activation', 'block5d_dwconv', 'block5d_bn', 'block5d_activation', 'block5d_se_squeeze', 'block5d_se_reshape', 'block5d_se_reduce', 'block5d_se_expand', 'block5d_se_excite', 'block5d_project_conv', 'block5d_project_bn', 'block5d_drop', 'block5d_add', 'block5e_expand_conv', 'block5e_expand_bn', 'block5e_expand_activation', 'block5e_dwconv', 'block5e_bn', 'block5e_activation', 'block5e_se_squeeze', 'block5e_se_reshape', 'block5e_se_reduce', 'block5e_se_expand', 'block5e_se_excite', 'block5e_project_conv', 'block5e_project_bn', 'block5e_drop', 'block5e_add', 'block5f_expand_conv', 'block5f_expand_bn', 'block5f_expand_activation', 'block5f_dwconv', 'block5f_bn', 'block5f_activation', 'block5f_se_squeeze', 'block5f_se_reshape', 'block5f_se_reduce', 'block5f_se_expand', 'block5f_se_excite', 'block5f_project_conv', 'block5f_project_bn', 'block5f_drop', 'block5f_add', 'block5g_expand_conv', 'block5g_expand_bn', 'block5g_expand_activation', 'block5g_dwconv', 'block5g_bn', 'block5g_activation', 'block5g_se_squeeze', 'block5g_se_reshape', 'block5g_se_reduce', 'block5g_se_expand', 'block5g_se_excite', 'block5g_project_conv', 'block5g_project_bn', 'block5g_drop', 'block5g_add', 'block5h_expand_conv', 'block5h_expand_bn', 'block5h_expand_activation', 'block5h_dwconv', 'block5h_bn', 'block5h_activation', 'block5h_se_squeeze', 'block5h_se_reshape', 'block5h_se_reduce', 'block5h_se_expand', 'block5h_se_excite', 'block5h_project_conv', 'block5h_project_bn', 'block5h_drop', 'block5h_add', 'block6a_expand_conv', 'block6a_expand_bn', 'block6a_expand_activation', 'block6a_dwconv_pad', 'block6a_dwconv', 'block6a_bn', 'block6a_activation', 'block6a_se_squeeze', 'block6a_se_reshape', 'block6a_se_reduce', 'block6a_se_expand', 'block6a_se_excite', 'block6a_project_conv', 'block6a_project_bn', 'block6b_expand_conv', 'block6b_expand_bn', 'block6b_expand_activation', 'block6b_dwconv', 'block6b_bn', 'block6b_activation', 'block6b_se_squeeze', 'block6b_se_reshape', 'block6b_se_reduce', 'block6b_se_expand', 'block6b_se_excite', 'block6b_project_conv', 'block6b_project_bn', 'block6b_drop', 'block6b_add', 'block6c_expand_conv', 'block6c_expand_bn', 'block6c_expand_activation', 'block6c_dwconv', 'block6c_bn', 'block6c_activation', 'block6c_se_squeeze', 'block6c_se_reshape', 'block6c_se_reduce', 'block6c_se_expand', 'block6c_se_excite', 'block6c_project_conv', 'block6c_project_bn', 'block6c_drop', 'block6c_add', 'block6d_expand_conv', 'block6d_expand_bn', 'block6d_expand_activation', 'block6d_dwconv', 'block6d_bn', 'block6d_activation', 'block6d_se_squeeze', 'block6d_se_reshape', 'block6d_se_reduce', 'block6d_se_expand', 'block6d_se_excite', 'block6d_project_conv', 'block6d_project_bn', 'block6d_drop', 'block6d_add', 'block6e_expand_conv', 'block6e_expand_bn', 'block6e_expand_activation', 'block6e_dwconv', 'block6e_bn', 'block6e_activation', 'block6e_se_squeeze', 'block6e_se_reshape', 'block6e_se_reduce', 'block6e_se_expand', 'block6e_se_excite', 'block6e_project_conv', 'block6e_project_bn', 'block6e_drop', 'block6e_add', 'block6f_expand_conv', 'block6f_expand_bn', 'block6f_expand_activation', 'block6f_dwconv', 'block6f_bn', 'block6f_activation', 'block6f_se_squeeze', 'block6f_se_reshape', 'block6f_se_reduce', 'block6f_se_expand', 'block6f_se_excite', 'block6f_project_conv', 'block6f_project_bn', 'block6f_drop', 'block6f_add', 'block6g_expand_conv', 'block6g_expand_bn', 'block6g_expand_activation', 'block6g_dwconv', 'block6g_bn', 'block6g_activation', 'block6g_se_squeeze', 'block6g_se_reshape', 'block6g_se_reduce', 'block6g_se_expand', 'block6g_se_excite', 'block6g_project_conv', 'block6g_project_bn', 'block6g_drop', 'block6g_add', 'block6h_expand_conv', 'block6h_expand_bn', 'block6h_expand_activation', 'block6h_dwconv', 'block6h_bn', 'block6h_activation', 'block6h_se_squeeze', 'block6h_se_reshape', 'block6h_se_reduce', 'block6h_se_expand', 'block6h_se_excite', 'block6h_project_conv', 'block6h_project_bn', 'block6h_drop', 'block6h_add', 'block6i_expand_conv', 'block6i_expand_bn', 'block6i_expand_activation', 'block6i_dwconv', 'block6i_bn', 'block6i_activation', 'block6i_se_squeeze', 'block6i_se_reshape', 'block6i_se_reduce', 'block6i_se_expand', 'block6i_se_excite', 'block6i_project_conv', 'block6i_project_bn', 'block6i_drop', 'block6i_add', 'block6j_expand_conv', 'block6j_expand_bn', 'block6j_expand_activation', 'block6j_dwconv', 'block6j_bn', 'block6j_activation', 'block6j_se_squeeze', 'block6j_se_reshape', 'block6j_se_reduce', 'block6j_se_expand', 'block6j_se_excite', 'block6j_project_conv', 'block6j_project_bn', 'block6j_drop', 'block6j_add', 'block6k_expand_conv', 'block6k_expand_bn', 'block6k_expand_activation', 'block6k_dwconv', 'block6k_bn', 'block6k_activation', 'block6k_se_squeeze', 'block6k_se_reshape', 'block6k_se_reduce', 'block6k_se_expand', 'block6k_se_excite', 'block6k_project_conv', 'block6k_project_bn', 'block6k_drop', 'block6k_add', 'block7a_expand_conv', 'block7a_expand_bn', 'block7a_expand_activation', 'block7a_dwconv', 'block7a_bn', 'block7a_activation', 'block7a_se_squeeze', 'block7a_se_reshape', 'block7a_se_reduce', 'block7a_se_expand', 'block7a_se_excite', 'block7a_project_conv', 'block7a_project_bn', 'block7b_expand_conv', 'block7b_expand_bn', 'block7b_expand_activation', 'block7b_dwconv', 'block7b_bn', 'block7b_activation', 'block7b_se_squeeze', 'block7b_se_reshape', 'block7b_se_reduce', 'block7b_se_expand', 'block7b_se_excite', 'block7b_project_conv', 'block7b_project_bn', 'block7b_drop', 'block7b_add', 'block7c_expand_conv', 'block7c_expand_bn', 'block7c_expand_activation', 'block7c_dwconv', 'block7c_bn', 'block7c_activation', 'block7c_se_squeeze', 'block7c_se_reshape', 'block7c_se_reduce', 'block7c_se_expand', 'block7c_se_excite', 'block7c_project_conv', 'block7c_project_bn', 'block7c_drop', 'block7c_add', 'top_conv', 'top_bn', 'top_activation', 'avg_pool', 'top_dropout', 'predictions']

b7_layer_names = ['input_6', 'rescaling_4', 'normalization_2', 'rescaling_5', 'stem_conv_pad', 'stem_conv', 'stem_bn', 'stem_activation',
                  'block1a_dwconv', 'block1a_bn', 'block1a_activation', 'block1a_se_squeeze', 'block1a_se_reshape', 'block1a_se_reduce', 'block1a_se_expand', 'block1a_se_excite', 'block1a_project_conv', 'block1a_project_bn',
                  'block1b_dwconv', 'block1b_bn', 'block1b_activation', 'block1b_se_squeeze', 'block1b_se_reshape', 'block1b_se_reduce', 'block1b_se_expand', 'block1b_se_excite', 'block1b_project_conv', 'block1b_project_bn', 'block1b_drop', 'block1b_add',
                  'block1c_dwconv', 'block1c_bn', 'block1c_activation', 'block1c_se_squeeze', 'block1c_se_reshape', 'block1c_se_reduce', 'block1c_se_expand', 'block1c_se_excite', 'block1c_project_conv', 'block1c_project_bn', 'block1c_drop', 'block1c_add',
                  'block1d_dwconv', 'block1d_bn', 'block1d_activation', 'block1d_se_squeeze', 'block1d_se_reshape', 'block1d_se_reduce', 'block1d_se_expand', 'block1d_se_excite', 'block1d_project_conv', 'block1d_project_bn', 'block1d_drop', 'block1d_add',

                  'block2a_expand_conv', 'block2a_expand_bn', 'block2a_expand_activation', 'block2a_dwconv_pad', 'block2a_dwconv', 'block2a_bn', 'block2a_activation', 'block2a_se_squeeze', 'block2a_se_reshape', 'block2a_se_reduce', 'block2a_se_expand', 'block2a_se_excite', 'block2a_project_conv', 'block2a_project_bn',  # skip_connection??
                  'block2b_expand_conv', 'block2b_expand_bn', 'block2b_expand_activation', 'block2b_dwconv', 'block2b_bn', 'block2b_activation', 'block2b_se_squeeze', 'block2b_se_reshape', 'block2b_se_reduce', 'block2b_se_expand', 'block2b_se_excite', 'block2b_project_conv', 'block2b_project_bn', 'block2b_drop', 'block2b_add',
                  'block2c_expand_conv', 'block2c_expand_bn', 'block2c_expand_activation', 'block2c_dwconv', 'block2c_bn', 'block2c_activation', 'block2c_se_squeeze', 'block2c_se_reshape', 'block2c_se_reduce', 'block2c_se_expand', 'block2c_se_excite', 'block2c_project_conv', 'block2c_project_bn', 'block2c_drop', 'block2c_add',
                  'block2d_expand_conv', 'block2d_expand_bn', 'block2d_expand_activation', 'block2d_dwconv', 'block2d_bn', 'block2d_activation', 'block2d_se_squeeze', 'block2d_se_reshape', 'block2d_se_reduce', 'block2d_se_expand', 'block2d_se_excite', 'block2d_project_conv', 'block2d_project_bn', 'block2d_drop', 'block2d_add',
                  'block2e_expand_conv', 'block2e_expand_bn', 'block2e_expand_activation', 'block2e_dwconv', 'block2e_bn', 'block2e_activation', 'block2e_se_squeeze', 'block2e_se_reshape', 'block2e_se_reduce', 'block2e_se_expand', 'block2e_se_excite', 'block2e_project_conv', 'block2e_project_bn', 'block2e_drop', 'block2e_add',
                  'block2f_expand_conv', 'block2f_expand_bn', 'block2f_expand_activation', 'block2f_dwconv', 'block2f_bn', 'block2f_activation', 'block2f_se_squeeze', 'block2f_se_reshape', 'block2f_se_reduce', 'block2f_se_expand', 'block2f_se_excite', 'block2f_project_conv', 'block2f_project_bn', 'block2f_drop', 'block2f_add',
                  'block2g_expand_conv', 'block2g_expand_bn', 'block2g_expand_activation', 'block2g_dwconv', 'block2g_bn', 'block2g_activation', 'block2g_se_squeeze', 'block2g_se_reshape', 'block2g_se_reduce', 'block2g_se_expand', 'block2g_se_excite', 'block2g_project_conv', 'block2g_project_bn', 'block2g_drop', 'block2g_add',

                  'block3a_expand_conv', 'block3a_expand_bn', 'block3a_expand_activation', 'block3a_dwconv_pad', 'block3a_dwconv', 'block3a_bn', 'block3a_activation', 'block3a_se_squeeze', 'block3a_se_reshape', 'block3a_se_reduce', 'block3a_se_expand', 'block3a_se_excite', 'block3a_project_conv', 'block3a_project_bn',
                  'block3b_expand_conv', 'block3b_expand_bn', 'block3b_expand_activation', 'block3b_dwconv', 'block3b_bn', 'block3b_activation', 'block3b_se_squeeze', 'block3b_se_reshape', 'block3b_se_reduce', 'block3b_se_expand', 'block3b_se_excite', 'block3b_project_conv', 'block3b_project_bn', 'block3b_drop', 'block3b_add',
                  'block3c_expand_conv', 'block3c_expand_bn', 'block3c_expand_activation', 'block3c_dwconv', 'block3c_bn', 'block3c_activation', 'block3c_se_squeeze', 'block3c_se_reshape', 'block3c_se_reduce', 'block3c_se_expand', 'block3c_se_excite', 'block3c_project_conv', 'block3c_project_bn', 'block3c_drop', 'block3c_add',
                  'block3d_expand_conv', 'block3d_expand_bn', 'block3d_expand_activation', 'block3d_dwconv', 'block3d_bn', 'block3d_activation', 'block3d_se_squeeze', 'block3d_se_reshape', 'block3d_se_reduce', 'block3d_se_expand', 'block3d_se_excite', 'block3d_project_conv', 'block3d_project_bn', 'block3d_drop', 'block3d_add',
                  'block3e_expand_conv', 'block3e_expand_bn', 'block3e_expand_activation', 'block3e_dwconv', 'block3e_bn', 'block3e_activation', 'block3e_se_squeeze', 'block3e_se_reshape', 'block3e_se_reduce', 'block3e_se_expand', 'block3e_se_excite', 'block3e_project_conv', 'block3e_project_bn', 'block3e_drop', 'block3e_add',
                  'block3f_expand_conv', 'block3f_expand_bn', 'block3f_expand_activation', 'block3f_dwconv', 'block3f_bn', 'block3f_activation', 'block3f_se_squeeze', 'block3f_se_reshape', 'block3f_se_reduce', 'block3f_se_expand', 'block3f_se_excite', 'block3f_project_conv', 'block3f_project_bn', 'block3f_drop', 'block3f_add',
                  'block3g_expand_conv', 'block3g_expand_bn', 'block3g_expand_activation', 'block3g_dwconv', 'block3g_bn', 'block3g_activation', 'block3g_se_squeeze', 'block3g_se_reshape', 'block3g_se_reduce', 'block3g_se_expand', 'block3g_se_excite', 'block3g_project_conv', 'block3g_project_bn', 'block3g_drop', 'block3g_add',

                  'block4a_expand_conv', 'block4a_expand_bn', 'block4a_expand_activation', 'block4a_dwconv_pad', 'block4a_dwconv', 'block4a_bn', 'block4a_activation', 'block4a_se_squeeze', 'block4a_se_reshape', 'block4a_se_reduce', 'block4a_se_expand', 'block4a_se_excite', 'block4a_project_conv', 'block4a_project_bn',
                  'block4b_expand_conv', 'block4b_expand_bn', 'block4b_expand_activation', 'block4b_dwconv', 'block4b_bn', 'block4b_activation', 'block4b_se_squeeze', 'block4b_se_reshape', 'block4b_se_reduce', 'block4b_se_expand', 'block4b_se_excite', 'block4b_project_conv', 'block4b_project_bn', 'block4b_drop', 'block4b_add',
                  'block4c_expand_conv', 'block4c_expand_bn', 'block4c_expand_activation', 'block4c_dwconv', 'block4c_bn', 'block4c_activation', 'block4c_se_squeeze', 'block4c_se_reshape', 'block4c_se_reduce', 'block4c_se_expand', 'block4c_se_excite', 'block4c_project_conv', 'block4c_project_bn', 'block4c_drop', 'block4c_add',
                  'block4d_expand_conv', 'block4d_expand_bn', 'block4d_expand_activation', 'block4d_dwconv', 'block4d_bn', 'block4d_activation', 'block4d_se_squeeze', 'block4d_se_reshape', 'block4d_se_reduce', 'block4d_se_expand', 'block4d_se_excite', 'block4d_project_conv', 'block4d_project_bn', 'block4d_drop', 'block4d_add',
                  'block4e_expand_conv', 'block4e_expand_bn', 'block4e_expand_activation', 'block4e_dwconv', 'block4e_bn', 'block4e_activation', 'block4e_se_squeeze', 'block4e_se_reshape', 'block4e_se_reduce', 'block4e_se_expand', 'block4e_se_excite', 'block4e_project_conv', 'block4e_project_bn', 'block4e_drop', 'block4e_add',
                  'block4f_expand_conv', 'block4f_expand_bn', 'block4f_expand_activation', 'block4f_dwconv', 'block4f_bn', 'block4f_activation', 'block4f_se_squeeze', 'block4f_se_reshape', 'block4f_se_reduce', 'block4f_se_expand', 'block4f_se_excite', 'block4f_project_conv', 'block4f_project_bn', 'block4f_drop', 'block4f_add',
                  'block4g_expand_conv', 'block4g_expand_bn', 'block4g_expand_activation', 'block4g_dwconv', 'block4g_bn', 'block4g_activation', 'block4g_se_squeeze', 'block4g_se_reshape', 'block4g_se_reduce', 'block4g_se_expand', 'block4g_se_excite', 'block4g_project_conv', 'block4g_project_bn', 'block4g_drop', 'block4g_add',
                  'block4h_expand_conv', 'block4h_expand_bn', 'block4h_expand_activation', 'block4h_dwconv', 'block4h_bn', 'block4h_activation', 'block4h_se_squeeze', 'block4h_se_reshape', 'block4h_se_reduce', 'block4h_se_expand', 'block4h_se_excite', 'block4h_project_conv', 'block4h_project_bn', 'block4h_drop', 'block4h_add',
                  'block4i_expand_conv', 'block4i_expand_bn', 'block4i_expand_activation', 'block4i_dwconv', 'block4i_bn', 'block4i_activation', 'block4i_se_squeeze', 'block4i_se_reshape', 'block4i_se_reduce', 'block4i_se_expand', 'block4i_se_excite', 'block4i_project_conv', 'block4i_project_bn', 'block4i_drop', 'block4i_add',
                  'block4j_expand_conv', 'block4j_expand_bn', 'block4j_expand_activation', 'block4j_dwconv', 'block4j_bn', 'block4j_activation', 'block4j_se_squeeze', 'block4j_se_reshape', 'block4j_se_reduce', 'block4j_se_expand', 'block4j_se_excite', 'block4j_project_conv', 'block4j_project_bn', 'block4j_drop', 'block4j_add',

                  'block5a_expand_conv', 'block5a_expand_bn', 'block5a_expand_activation', 'block5a_dwconv', 'block5a_bn', 'block5a_activation', 'block5a_se_squeeze', 'block5a_se_reshape', 'block5a_se_reduce', 'block5a_se_expand', 'block5a_se_excite', 'block5a_project_conv', 'block5a_project_bn',
                  'block5b_expand_conv', 'block5b_expand_bn', 'block5b_expand_activation', 'block5b_dwconv', 'block5b_bn', 'block5b_activation', 'block5b_se_squeeze', 'block5b_se_reshape', 'block5b_se_reduce', 'block5b_se_expand', 'block5b_se_excite', 'block5b_project_conv', 'block5b_project_bn', 'block5b_drop', 'block5b_add',
                  'block5c_expand_conv', 'block5c_expand_bn', 'block5c_expand_activation', 'block5c_dwconv', 'block5c_bn', 'block5c_activation', 'block5c_se_squeeze', 'block5c_se_reshape', 'block5c_se_reduce', 'block5c_se_expand', 'block5c_se_excite', 'block5c_project_conv', 'block5c_project_bn', 'block5c_drop', 'block5c_add',
                  'block5d_expand_conv', 'block5d_expand_bn', 'block5d_expand_activation', 'block5d_dwconv', 'block5d_bn', 'block5d_activation', 'block5d_se_squeeze', 'block5d_se_reshape', 'block5d_se_reduce', 'block5d_se_expand', 'block5d_se_excite', 'block5d_project_conv', 'block5d_project_bn', 'block5d_drop', 'block5d_add',
                  'block5e_expand_conv', 'block5e_expand_bn', 'block5e_expand_activation', 'block5e_dwconv', 'block5e_bn', 'block5e_activation', 'block5e_se_squeeze', 'block5e_se_reshape', 'block5e_se_reduce', 'block5e_se_expand', 'block5e_se_excite', 'block5e_project_conv', 'block5e_project_bn', 'block5e_drop', 'block5e_add',
                  'block5f_expand_conv', 'block5f_expand_bn', 'block5f_expand_activation', 'block5f_dwconv', 'block5f_bn', 'block5f_activation', 'block5f_se_squeeze', 'block5f_se_reshape', 'block5f_se_reduce', 'block5f_se_expand', 'block5f_se_excite', 'block5f_project_conv', 'block5f_project_bn', 'block5f_drop', 'block5f_add',
                  'block5g_expand_conv', 'block5g_expand_bn', 'block5g_expand_activation', 'block5g_dwconv', 'block5g_bn', 'block5g_activation', 'block5g_se_squeeze', 'block5g_se_reshape', 'block5g_se_reduce', 'block5g_se_expand', 'block5g_se_excite', 'block5g_project_conv', 'block5g_project_bn', 'block5g_drop', 'block5g_add',
                  'block5h_expand_conv', 'block5h_expand_bn', 'block5h_expand_activation', 'block5h_dwconv', 'block5h_bn', 'block5h_activation', 'block5h_se_squeeze', 'block5h_se_reshape', 'block5h_se_reduce', 'block5h_se_expand', 'block5h_se_excite', 'block5h_project_conv', 'block5h_project_bn', 'block5h_drop', 'block5h_add',
                  'block5i_expand_conv', 'block5i_expand_bn', 'block5i_expand_activation', 'block5i_dwconv', 'block5i_bn', 'block5i_activation', 'block5i_se_squeeze', 'block5i_se_reshape', 'block5i_se_reduce', 'block5i_se_expand', 'block5i_se_excite', 'block5i_project_conv', 'block5i_project_bn', 'block5i_drop', 'block5i_add',
                  'block5j_expand_conv', 'block5j_expand_bn', 'block5j_expand_activation', 'block5j_dwconv', 'block5j_bn', 'block5j_activation', 'block5j_se_squeeze', 'block5j_se_reshape', 'block5j_se_reduce', 'block5j_se_expand', 'block5j_se_excite', 'block5j_project_conv', 'block5j_project_bn', 'block5j_drop', 'block5j_add',

                  'block6a_expand_conv', 'block6a_expand_bn', 'block6a_expand_activation', 'block6a_dwconv_pad', 'block6a_dwconv', 'block6a_bn', 'block6a_activation', 'block6a_se_squeeze', 'block6a_se_reshape', 'block6a_se_reduce', 'block6a_se_expand', 'block6a_se_excite', 'block6a_project_conv', 'block6a_project_bn',
                  'block6b_expand_conv', 'block6b_expand_bn', 'block6b_expand_activation', 'block6b_dwconv', 'block6b_bn', 'block6b_activation', 'block6b_se_squeeze', 'block6b_se_reshape', 'block6b_se_reduce', 'block6b_se_expand', 'block6b_se_excite', 'block6b_project_conv', 'block6b_project_bn', 'block6b_drop', 'block6b_add',
                  'block6c_expand_conv', 'block6c_expand_bn', 'block6c_expand_activation', 'block6c_dwconv', 'block6c_bn', 'block6c_activation', 'block6c_se_squeeze', 'block6c_se_reshape', 'block6c_se_reduce', 'block6c_se_expand', 'block6c_se_excite', 'block6c_project_conv', 'block6c_project_bn', 'block6c_drop', 'block6c_add',
                  'block6d_expand_conv', 'block6d_expand_bn', 'block6d_expand_activation', 'block6d_dwconv', 'block6d_bn', 'block6d_activation', 'block6d_se_squeeze', 'block6d_se_reshape', 'block6d_se_reduce', 'block6d_se_expand', 'block6d_se_excite', 'block6d_project_conv', 'block6d_project_bn', 'block6d_drop', 'block6d_add',
                  'block6e_expand_conv', 'block6e_expand_bn', 'block6e_expand_activation', 'block6e_dwconv', 'block6e_bn', 'block6e_activation', 'block6e_se_squeeze', 'block6e_se_reshape', 'block6e_se_reduce', 'block6e_se_expand', 'block6e_se_excite', 'block6e_project_conv', 'block6e_project_bn', 'block6e_drop', 'block6e_add',
                  'block6f_expand_conv', 'block6f_expand_bn', 'block6f_expand_activation', 'block6f_dwconv', 'block6f_bn', 'block6f_activation', 'block6f_se_squeeze', 'block6f_se_reshape', 'block6f_se_reduce', 'block6f_se_expand', 'block6f_se_excite', 'block6f_project_conv', 'block6f_project_bn', 'block6f_drop', 'block6f_add',
                  'block6g_expand_conv', 'block6g_expand_bn', 'block6g_expand_activation', 'block6g_dwconv', 'block6g_bn', 'block6g_activation', 'block6g_se_squeeze', 'block6g_se_reshape', 'block6g_se_reduce', 'block6g_se_expand', 'block6g_se_excite', 'block6g_project_conv', 'block6g_project_bn', 'block6g_drop', 'block6g_add',
                  'block6h_expand_conv', 'block6h_expand_bn', 'block6h_expand_activation', 'block6h_dwconv', 'block6h_bn', 'block6h_activation', 'block6h_se_squeeze', 'block6h_se_reshape', 'block6h_se_reduce', 'block6h_se_expand', 'block6h_se_excite', 'block6h_project_conv', 'block6h_project_bn', 'block6h_drop', 'block6h_add',
                  'block6i_expand_conv', 'block6i_expand_bn', 'block6i_expand_activation', 'block6i_dwconv', 'block6i_bn', 'block6i_activation', 'block6i_se_squeeze', 'block6i_se_reshape', 'block6i_se_reduce', 'block6i_se_expand', 'block6i_se_excite', 'block6i_project_conv', 'block6i_project_bn', 'block6i_drop', 'block6i_add',
                  'block6j_expand_conv', 'block6j_expand_bn', 'block6j_expand_activation', 'block6j_dwconv', 'block6j_bn', 'block6j_activation', 'block6j_se_squeeze', 'block6j_se_reshape', 'block6j_se_reduce', 'block6j_se_expand', 'block6j_se_excite', 'block6j_project_conv', 'block6j_project_bn', 'block6j_drop', 'block6j_add',
                  'block6k_expand_conv', 'block6k_expand_bn', 'block6k_expand_activation', 'block6k_dwconv', 'block6k_bn', 'block6k_activation', 'block6k_se_squeeze', 'block6k_se_reshape', 'block6k_se_reduce', 'block6k_se_expand', 'block6k_se_excite', 'block6k_project_conv', 'block6k_project_bn', 'block6k_drop', 'block6k_add',
                  'block6l_expand_conv', 'block6l_expand_bn', 'block6l_expand_activation', 'block6l_dwconv', 'block6l_bn', 'block6l_activation', 'block6l_se_squeeze', 'block6l_se_reshape', 'block6l_se_reduce', 'block6l_se_expand', 'block6l_se_excite', 'block6l_project_conv', 'block6l_project_bn', 'block6l_drop', 'block6l_add',
                  'block6m_expand_conv', 'block6m_expand_bn', 'block6m_expand_activation', 'block6m_dwconv', 'block6m_bn', 'block6m_activation', 'block6m_se_squeeze', 'block6m_se_reshape', 'block6m_se_reduce', 'block6m_se_expand', 'block6m_se_excite', 'block6m_project_conv', 'block6m_project_bn', 'block6m_drop', 'block6m_add',

                  'block7a_expand_conv', 'block7a_expand_bn', 'block7a_expand_activation', 'block7a_dwconv', 'block7a_bn', 'block7a_activation', 'block7a_se_squeeze', 'block7a_se_reshape', 'block7a_se_reduce', 'block7a_se_expand', 'block7a_se_excite', 'block7a_project_conv', 'block7a_project_bn',
                  'block7b_expand_conv', 'block7b_expand_bn', 'block7b_expand_activation', 'block7b_dwconv', 'block7b_bn', 'block7b_activation', 'block7b_se_squeeze', 'block7b_se_reshape', 'block7b_se_reduce', 'block7b_se_expand', 'block7b_se_excite', 'block7b_project_conv', 'block7b_project_bn', 'block7b_drop', 'block7b_add',
                  'block7c_expand_conv', 'block7c_expand_bn', 'block7c_expand_activation', 'block7c_dwconv', 'block7c_bn', 'block7c_activation', 'block7c_se_squeeze', 'block7c_se_reshape', 'block7c_se_reduce', 'block7c_se_expand', 'block7c_se_excite', 'block7c_project_conv', 'block7c_project_bn', 'block7c_drop', 'block7c_add',
                  'block7d_expand_conv', 'block7d_expand_bn', 'block7d_expand_activation', 'block7d_dwconv', 'block7d_bn', 'block7d_activation', 'block7d_se_squeeze', 'block7d_se_reshape', 'block7d_se_reduce', 'block7d_se_expand', 'block7d_se_excite', 'block7d_project_conv', 'block7d_project_bn', 'block7d_drop', 'block7d_add',
                  'top_conv', 'top_bn', 'top_activation', 'avg_pool', 'top_dropout', 'predictions']


# target_layers = ["block1a_project_bn", 'block1d_add', 'block2g_add', 'block3g_add', 'block4j_add', 'block5j_add', 'block6m_add', 'block7d_add']

last_stage_layers = [
    'block7a_expand_conv', 'block7a_expand_bn', 'block7a_expand_activation', 'block7a_dwconv', 'block7a_bn',
    'block7a_activation', 'block7a_se_squeeze', 'block7a_se_reshape', 'block7a_se_reduce', 'block7a_se_expand',
    'block7a_se_excite', 'block7a_project_conv', 'block7a_project_bn',
    'block7b_expand_conv', 'block7b_expand_bn', 'block7b_expand_activation', 'block7b_dwconv', 'block7b_bn',
    'block7b_activation', 'block7b_se_squeeze', 'block7b_se_reshape', 'block7b_se_reduce', 'block7b_se_expand',
    'block7b_se_excite', 'block7b_project_conv', 'block7b_project_bn', 'block7b_drop', 'block7b_add',
    'block7c_expand_conv', 'block7c_expand_bn', 'block7c_expand_activation', 'block7c_dwconv', 'block7c_bn',
    'block7c_activation', 'block7c_se_squeeze', 'block7c_se_reshape', 'block7c_se_reduce', 'block7c_se_expand',
    'block7c_se_excite', 'block7c_project_conv', 'block7c_project_bn', 'block7c_drop', 'block7c_add',
    'block7d_expand_conv', 'block7d_expand_bn', 'block7d_expand_activation', 'block7d_dwconv', 'block7d_bn',
    'block7d_activation', 'block7d_se_squeeze', 'block7d_se_reshape', 'block7d_se_reduce', 'block7d_se_expand',
    'block7d_se_excite', 'block7d_project_conv', 'block7d_project_bn', 'block7d_drop', 'block7d_add',
]
last_block_layers = [
    'block7d_expand_conv', 'block7d_expand_bn', 'block7d_expand_activation', 'block7d_dwconv', 'block7d_bn',
    'block7d_activation', 'block7d_se_squeeze', 'block7d_se_reshape', 'block7d_se_reduce', 'block7d_se_expand',
    'block7d_se_excite', 'block7d_project_conv', 'block7d_project_bn', 'block7d_drop', 'block7d_add',
]

efficientnetb1 = ['input_1', 'rescaling', 'normalization', 'stem_conv_pad', 'stem_conv', 'stem_bn', 'stem_activation',
                  'block1a_dwconv', 'block1a_bn', 'block1a_activation', 'block1a_se_squeeze', 'block1a_se_reshape', 'block1a_se_reduce', 'block1a_se_expand', 'block1a_se_excite', 'block1a_project_conv', 'block1a_project_bn',
                  'block1b_dwconv', 'block1b_bn', 'block1b_activation', 'block1b_se_squeeze', 'block1b_se_reshape', 'block1b_se_reduce', 'block1b_se_expand', 'block1b_se_excite', 'block1b_project_conv', 'block1b_project_bn', 'block1b_drop', 'block1b_add',
                  'block2a_expand_conv', 'block2a_expand_bn', 'block2a_expand_activation', 'block2a_dwconv_pad', 'block2a_dwconv', 'block2a_bn', 'block2a_activation', 'block2a_se_squeeze', 'block2a_se_reshape', 'block2a_se_reduce', 'block2a_se_expand', 'block2a_se_excite', 'block2a_project_conv', 'block2a_project_bn',
                  'block2b_expand_conv', 'block2b_expand_bn', 'block2b_expand_activation', 'block2b_dwconv', 'block2b_bn', 'block2b_activation', 'block2b_se_squeeze', 'block2b_se_reshape', 'block2b_se_reduce', 'block2b_se_expand', 'block2b_se_excite', 'block2b_project_conv', 'block2b_project_bn', 'block2b_drop', 'block2b_add',
                  'block2c_expand_conv', 'block2c_expand_bn', 'block2c_expand_activation', 'block2c_dwconv', 'block2c_bn', 'block2c_activation', 'block2c_se_squeeze', 'block2c_se_reshape', 'block2c_se_reduce', 'block2c_se_expand', 'block2c_se_excite', 'block2c_project_conv', 'block2c_project_bn', 'block2c_drop', 'block2c_add',
                  'block3a_expand_conv', 'block3a_expand_bn', 'block3a_expand_activation', 'block3a_dwconv_pad', 'block3a_dwconv', 'block3a_bn', 'block3a_activation', 'block3a_se_squeeze', 'block3a_se_reshape', 'block3a_se_reduce', 'block3a_se_expand', 'block3a_se_excite', 'block3a_project_conv', 'block3a_project_bn',
                  'block3b_expand_conv', 'block3b_expand_bn', 'block3b_expand_activation', 'block3b_dwconv', 'block3b_bn', 'block3b_activation', 'block3b_se_squeeze', 'block3b_se_reshape', 'block3b_se_reduce', 'block3b_se_expand', 'block3b_se_excite', 'block3b_project_conv', 'block3b_project_bn', 'block3b_drop', 'block3b_add',
                  'block3c_expand_conv', 'block3c_expand_bn', 'block3c_expand_activation', 'block3c_dwconv', 'block3c_bn', 'block3c_activation', 'block3c_se_squeeze', 'block3c_se_reshape', 'block3c_se_reduce', 'block3c_se_expand', 'block3c_se_excite', 'block3c_project_conv', 'block3c_project_bn', 'block3c_drop', 'block3c_add',
                  'block4a_expand_conv', 'block4a_expand_bn', 'block4a_expand_activation', 'block4a_dwconv_pad', 'block4a_dwconv', 'block4a_bn', 'block4a_activation', 'block4a_se_squeeze', 'block4a_se_reshape', 'block4a_se_reduce', 'block4a_se_expand', 'block4a_se_excite', 'block4a_project_conv', 'block4a_project_bn',
                  'block4b_expand_conv', 'block4b_expand_bn', 'block4b_expand_activation', 'block4b_dwconv', 'block4b_bn', 'block4b_activation', 'block4b_se_squeeze', 'block4b_se_reshape', 'block4b_se_reduce', 'block4b_se_expand', 'block4b_se_excite', 'block4b_project_conv', 'block4b_project_bn', 'block4b_drop', 'block4b_add',
                  'block4c_expand_conv', 'block4c_expand_bn', 'block4c_expand_activation', 'block4c_dwconv', 'block4c_bn', 'block4c_activation', 'block4c_se_squeeze', 'block4c_se_reshape', 'block4c_se_reduce', 'block4c_se_expand', 'block4c_se_excite', 'block4c_project_conv', 'block4c_project_bn', 'block4c_drop', 'block4c_add',
                  'block4d_expand_conv', 'block4d_expand_bn', 'block4d_expand_activation', 'block4d_dwconv', 'block4d_bn', 'block4d_activation', 'block4d_se_squeeze', 'block4d_se_reshape', 'block4d_se_reduce', 'block4d_se_expand', 'block4d_se_excite', 'block4d_project_conv', 'block4d_project_bn', 'block4d_drop', 'block4d_add',
                  'block5a_expand_conv', 'block5a_expand_bn', 'block5a_expand_activation', 'block5a_dwconv', 'block5a_bn', 'block5a_activation', 'block5a_se_squeeze', 'block5a_se_reshape', 'block5a_se_reduce', 'block5a_se_expand', 'block5a_se_excite', 'block5a_project_conv', 'block5a_project_bn',
                  'block5b_expand_conv', 'block5b_expand_bn', 'block5b_expand_activation', 'block5b_dwconv', 'block5b_bn', 'block5b_activation', 'block5b_se_squeeze', 'block5b_se_reshape', 'block5b_se_reduce', 'block5b_se_expand', 'block5b_se_excite', 'block5b_project_conv', 'block5b_project_bn', 'block5b_drop', 'block5b_add',
                  'block5c_expand_conv', 'block5c_expand_bn', 'block5c_expand_activation', 'block5c_dwconv', 'block5c_bn', 'block5c_activation', 'block5c_se_squeeze', 'block5c_se_reshape', 'block5c_se_reduce', 'block5c_se_expand', 'block5c_se_excite', 'block5c_project_conv', 'block5c_project_bn', 'block5c_drop', 'block5c_add',
                  'block5d_expand_conv', 'block5d_expand_bn', 'block5d_expand_activation', 'block5d_dwconv', 'block5d_bn', 'block5d_activation', 'block5d_se_squeeze', 'block5d_se_reshape', 'block5d_se_reduce', 'block5d_se_expand', 'block5d_se_excite', 'block5d_project_conv', 'block5d_project_bn', 'block5d_drop', 'block5d_add',
                  'block6a_expand_conv', 'block6a_expand_bn', 'block6a_expand_activation', 'block6a_dwconv_pad', 'block6a_dwconv', 'block6a_bn', 'block6a_activation', 'block6a_se_squeeze', 'block6a_se_reshape', 'block6a_se_reduce', 'block6a_se_expand', 'block6a_se_excite', 'block6a_project_conv', 'block6a_project_bn',
                  'block6b_expand_conv', 'block6b_expand_bn', 'block6b_expand_activation', 'block6b_dwconv', 'block6b_bn', 'block6b_activation', 'block6b_se_squeeze', 'block6b_se_reshape', 'block6b_se_reduce', 'block6b_se_expand', 'block6b_se_excite', 'block6b_project_conv', 'block6b_project_bn', 'block6b_drop', 'block6b_add',
                  'block6c_expand_conv', 'block6c_expand_bn', 'block6c_expand_activation', 'block6c_dwconv', 'block6c_bn', 'block6c_activation', 'block6c_se_squeeze', 'block6c_se_reshape', 'block6c_se_reduce', 'block6c_se_expand', 'block6c_se_excite', 'block6c_project_conv', 'block6c_project_bn', 'block6c_drop', 'block6c_add',
                  'block6d_expand_conv', 'block6d_expand_bn', 'block6d_expand_activation', 'block6d_dwconv', 'block6d_bn', 'block6d_activation', 'block6d_se_squeeze', 'block6d_se_reshape', 'block6d_se_reduce', 'block6d_se_expand', 'block6d_se_excite', 'block6d_project_conv', 'block6d_project_bn', 'block6d_drop', 'block6d_add',
                  'block6e_expand_conv', 'block6e_expand_bn', 'block6e_expand_activation', 'block6e_dwconv', 'block6e_bn', 'block6e_activation', 'block6e_se_squeeze', 'block6e_se_reshape', 'block6e_se_reduce', 'block6e_se_expand', 'block6e_se_excite', 'block6e_project_conv', 'block6e_project_bn', 'block6e_drop', 'block6e_add',
                  'block7a_expand_conv', 'block7a_expand_bn', 'block7a_expand_activation', 'block7a_dwconv', 'block7a_bn', 'block7a_activation', 'block7a_se_squeeze', 'block7a_se_reshape', 'block7a_se_reduce', 'block7a_se_expand', 'block7a_se_excite', 'block7a_project_conv', 'block7a_project_bn',
                  'block7b_expand_conv', 'block7b_expand_bn', 'block7b_expand_activation', 'block7b_dwconv', 'block7b_bn', 'block7b_activation', 'block7b_se_squeeze', 'block7b_se_reshape', 'block7b_se_reduce', 'block7b_se_expand', 'block7b_se_excite', 'block7b_project_conv', 'block7b_project_bn', 'block7b_drop', 'block7b_add',
                  'top_conv', 'top_bn', 'top_activation']

target_layers = ['block1b_add', 'block2c_add', 'block3c_add', 'block4d_add', 'block5d_add', 'block6e_add', 'block7b_add']

# [28, 72, 116, 175, 233, 307, 335]
first_stage_index = 28 + 1
second_stage_index = 72 + 1
third_stage_index = 116 + 1
fouth_stage_index = 175 + 1
fifth_stage_index = 233 + 1
sixth_stage_index = 307 + 1
last_stage_index = 335 + 1


if __name__ == '__main__':

    efficientnet_b1 = tf.keras.applications.efficientnet.EfficientNetB1(
        include_top=False,
        weights=None,
        input_shape=configs.input_shape,
    )

    layer_names = [layer.name for layer in efficientnet_b1.layers]
    layer_indices = [layer_names.index(target_layer) for target_layer in target_layers]
    print(layer_indices)

    print(111)